# -------------------------------------------------
# üß† Backend - Node.js (Produ√ß√£o)
# -------------------------------------------------
FROM node:20-alpine

# Define diret√≥rio de trabalho dentro do container
WORKDIR /app

# Copia arquivos de depend√™ncias primeiro (melhor cache no build)
COPY package*.json ./

# Instala apenas depend√™ncias de produ√ß√£o
RUN npm ci --only=production

# Copia o restante do c√≥digo da aplica√ß√£o
COPY . .

# Define vari√°veis de ambiente padr√£o
ENV NODE_ENV=production
ENV PORT=3001
ENV TZ=America/Sao_Paulo

# Exp√µe a porta interna usada pelo app (mesma configurada no compose)
EXPOSE 3001

# Healthcheck opcional (o compose j√° usa, mas deixa pronto se rodar isolado)
HEALTHCHECK --interval=30s --timeout=5s --start-period=10s \
  CMD wget -q --spider http://localhost:3001/health || exit 1

# Comando para iniciar o servidor (ajuste se o seu arquivo for index.js ou app.js)
CMD ["node", "server.js"]


